<svg viewBox="0 0 1200 800" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="userGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4F46E5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7C3AED;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="streamlitGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FF4B4B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#FF6B6B;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="llamaGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="geminiGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#F59E0B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#D97706;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="dataGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6366F1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4F46E5;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="3" dy="3" stdDeviation="3" flood-color="#00000020"/>
    </filter>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="800" fill="#F8FAFC"/>
  
  <!-- Title -->
  <text x="600" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#1E293B">泰戈尔作品问答系统架构</text>
  
  <!-- User Layer -->
  <g transform="translate(50, 80)">
    <rect x="0" y="0" width="200" height="80" rx="15" fill="url(#userGradient)" filter="url(#shadow)"/>
    <text x="100" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">用户界面</text>
    <text x="100" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">User Interface</text>
    <text x="100" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#E0E7FF">输入问题</text>
  </g>
  
  <!-- Streamlit Frontend -->
  <g transform="translate(350, 80)">
    <rect x="0" y="0" width="200" height="80" rx="15" fill="url(#streamlitGradient)" filter="url(#shadow)"/>
    <text x="100" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">Streamlit 前端</text>
    <text x="100" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">• 聊天界面</text>
    <text x="100" y="58" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">• 会话管理</text>
    <text x="100" y="71" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">• 错误处理</text>
  </g>
  
  <!-- LlamaIndex RAG Engine -->
  <g transform="translate(200, 220)">
    <rect x="0" y="0" width="300" height="120" rx="15" fill="url(#llamaGradient)" filter="url(#shadow)"/>
    <text x="150" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">LlamaIndex RAG 引擎</text>
    <text x="150" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">检索增强生成</text>
    
    <!-- Sub-components -->
    <g transform="translate(20, 55)">
      <rect x="0" y="0" width="80" height="40" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="40" y="15" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Query</text>
      <text x="40" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Processing</text>
    </g>
    
    <g transform="translate(110, 55)">
      <rect x="0" y="0" width="80" height="40" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="40" y="15" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Vector</text>
      <text x="40" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Retrieval</text>
    </g>
    
    <g transform="translate(200, 55)">
      <rect x="0" y="0" width="80" height="40" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="40" y="15" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Context</text>
      <text x="40" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Fusion</text>
    </g>
  </g>
  
  <!-- Data Processing Layer -->
  <g transform="translate(50, 380)">
    <rect x="0" y="0" width="500" height="100" rx="15" fill="url(#dataGradient)" filter="url(#shadow)"/>
    <text x="250" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">数据处理层</text>
    
    <!-- Document Reader -->
    <g transform="translate(20, 35)">
      <rect x="0" y="0" width="100" height="50" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="50" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Document</text>
      <text x="50" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Reader</text>
    </g>
    
    <!-- Chunking -->
    <g transform="translate(140, 35)">
      <rect x="0" y="0" width="100" height="50" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="50" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Text</text>
      <text x="50" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Chunking</text>
    </g>
    
    <!-- Embedding -->
    <g transform="translate(260, 35)">
      <rect x="0" y="0" width="100" height="50" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="50" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Gemini</text>
      <text x="50" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Embedding</text>
    </g>
    
    <!-- Vector Index -->
    <g transform="translate(380, 35)">
      <rect x="0" y="0" width="100" height="50" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="50" y="20" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Vector</text>
      <text x="50" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Index</text>
    </g>
  </g>
  
  <!-- Google Gemini API -->
  <g transform="translate(650, 220)">
    <rect x="0" y="0" width="200" height="120" rx="15" fill="url(#geminiGradient)" filter="url(#shadow)"/>
    <text x="100" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="white">Google Gemini</text>
    <text x="100" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">LLM API</text>
    
    <g transform="translate(20, 55)">
      <rect x="0" y="0" width="160" height="50" rx="8" fill="#FFFFFF30" stroke="white" stroke-width="1"/>
      <text x="80" y="15" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">Gemini 1.5 Flash</text>
      <text x="80" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">• 专家系统提示</text>
      <text x="80" y="40" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">• 安全过滤</text>
    </g>
  </g>
  
  <!-- Data Storage -->
  <g transform="translate(650, 380)">
    <rect x="0" y="0" width="200" height="100" rx="15" fill="#64748B" filter="url(#shadow)"/>
    <text x="100" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">数据存储</text>
    <text x="100" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">./data 目录</text>
    <text x="100" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">泰戈尔作品文档</text>
    <text x="100" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">递归读取</text>
  </g>
  
  <!-- Session State -->
  <g transform="translate(950, 80)">
    <rect x="0" y="0" width="180" height="100" rx="15" fill="#8B5CF6" filter="url(#shadow)"/>
    <text x="90" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="white">会话状态</text>
    <text x="90" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">• 消息历史</text>
    <text x="90" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">• 聊天引擎</text>
    <text x="90" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white">• 缓存管理</text>
  </g>
  
  <!-- Arrows -->
  <!-- User to Streamlit -->
  <path d="M 250 120 L 350 120" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Streamlit to RAG -->
  <path d="M 450 160 L 350 220" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- RAG to Gemini -->
  <path d="M 500 280 L 650 280" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Data to RAG -->
  <path d="M 300 380 L 350 340" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Storage to Data Processing -->
  <path d="M 650 430 L 550 430" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Streamlit to Session -->
  <path d="M 550 120 L 950 120" stroke="#374151" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- Return arrows -->
  <path d="M 650 300 L 500 300" stroke="#059669" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <path d="M 350 300 L 450 180" stroke="#059669" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  <path d="M 350 140 L 250 140" stroke="#059669" stroke-width="2" fill="none" marker-end="url(#arrowhead)" stroke-dasharray="5,5"/>
  
  <!-- Arrow marker -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151"/>
    </marker>
  </defs>
  
  <!-- Data Flow Labels -->
  <text x="300" y="110" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6B7280">问题输入</text>
  <text x="400" y="200" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6B7280">查询处理</text>
  <text x="575" y="270" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6B7280">增强提示</text>
  <text x="575" y="310" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#059669">生成回答</text>
  <text x="400" y="320" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#059669">流式响应</text>
  <text x="300" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#059669">显示结果</text>
  
  <!-- Technical Details Box -->
  <g transform="translate(50, 550)">
    <rect x="0" y="0" width="1100" height="180" rx="15" fill="#F1F5F9" stroke="#CBD5E1" stroke-width="2"/>
    <text x="550" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1E293B">技术实现细节</text>
    
    <g transform="translate(30, 45)">
      <text x="0" y="0" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">数据处理配置：</text>
      <text x="0" y="20" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• Chunk Size: 1500 tokens</text>
      <text x="0" y="35" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• Chunk Overlap: 50 tokens</text>
      <text x="0" y="50" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 递归目录读取</text>
      
      <text x="300" y="0" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">LLM 设置：</text>
      <text x="300" y="20" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 模型: Gemini 1.5 Flash</text>
      <text x="300" y="35" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• Temperature: 1.0</text>
      <text x="300" y="50" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 专家系统提示</text>
      
      <text x="600" y="0" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">安全机制：</text>
      <text x="600" y="20" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 内容安全过滤</text>
      <text x="600" y="35" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 错误重试机制</text>
      <text x="600" y="50" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 用户友好错误提示</text>
      
      <text x="0" y="80" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">性能优化：</text>
      <text x="0" y="100" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• @st.cache_resource 缓存模型加载</text>
      <text x="0" y="115" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• @st.cache_data 缓存数据处理</text>
      
      <text x="400" y="80" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">交互特性：</text>
      <text x="400" y="100" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 流式响应显示</text>
      <text x="400" y="115" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 会话历史管理</text>
      
      <text x="700" y="80" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#374151">文风设定：</text>
      <text x="700" y="100" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 早期现代主义风格</text>
      <text x="700" y="115" font-family="Arial, sans-serif" font-size="11" fill="#6B7280">• 华丽但直接的语调</text>
    </g>
  </g>
  
</svg>
